"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[261],{4261:(U,p,d)=>{d.r(p),d.d(p,{CreateRidePage:()=>w});var _=d(467),e=d(3953),g=d(177),a=d(4341),c=d(1019),h=d(5329),C=d(8986),f=d(2672),M=d(9520),u=d(7294),v=d(3724);function P(i,m){1&i&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1," Seat Available "),e.\u0275\u0275elementEnd())}function D(i,m){1&i&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1,"Seat required"),e.\u0275\u0275elementEnd())}function y(i,m){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-col",26)(1,"p"),e.\u0275\u0275text(2,"Price Per Person"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4,"Rs-"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"input",27),e.\u0275\u0275twoWayListener("ngModelChange",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275twoWayBindingSet(r.price,n)||(r.price=n),e.\u0275\u0275resetView(n)}),e.\u0275\u0275elementEnd()()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275twoWayProperty("ngModel",o.price)}}function O(i,m){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-col",28)(1,"input",29),e.\u0275\u0275twoWayListener("ngModelChange",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275twoWayBindingSet(r.companionNames,n)||(r.companionNames=n),e.\u0275\u0275resetView(n)}),e.\u0275\u0275elementEnd()()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275twoWayProperty("ngModel",o.companionNames)}}function b(i,m){if(1&i&&(e.\u0275\u0275elementStart(0,"option",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const o=m.$implicit;e.\u0275\u0275property("value",o.vehicleName),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",o.vehicleName," ")}}function x(i,m){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-col",30)(1,"select",31),e.\u0275\u0275twoWayListener("ngModelChange",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275twoWayBindingSet(r.vehicle,n)||(r.vehicle=n),e.\u0275\u0275resetView(n)}),e.\u0275\u0275listener("ngModelChange",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onVehicleChange(n))}),e.\u0275\u0275template(2,b,2,2,"option",32),e.\u0275\u0275elementEnd()()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275twoWayProperty("ngModel",o.vehicle),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",o.carDetails)}}function E(i,m){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-col",34)(1,"p",35),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.vehicles())}),e.\u0275\u0275text(2,"Enter car details first in the profile section "),e.\u0275\u0275elementStart(3,"span",36),e.\u0275\u0275text(4,"\u2192"),e.\u0275\u0275elementEnd()()()}}let w=(()=>{var i;class m{constructor(t){this.FormBuilder=t,this.handleData=(0,e.inject)(C.K),this.localStorageService=(0,e.inject)(f.s),this.commonService=(0,e.inject)(M.h),this.email=this.commonService.currentUserEmail,this.users=[],this.rideCreatedBy="driver",this.time="",this.date="",this.seatAvl=1,this.price=0,this.companionNames="",this.rideDistance="",this.rideDuration="",this.minDate="",this.router=(0,e.inject)(v.Ix),this.createRideForm=this.FormBuilder.group({from:["",a.k0.required],to:["",a.k0.required],time:["",a.k0.required],date:["",a.k0.required],seatAvl:["",a.k0.required],price:["",a.k0.required],rideType:["driver"],companionNames:[""],vehicle:[""]})}ngOnInit(){this.createRideForm.get("rideType").valueChanges.subscribe(t=>{console.log("Is Driver:","driver"===t),this.rideCreatedBy=t,console.log("this.rideCreatedBy === ",this.rideCreatedBy),console.log("Is Companion:","companion"===t)})}ionViewWillEnter(){this.setDateToCurrent(),this.setMinDate(),console.log("this.email === ",this.email),this.handleData.userExists(this.email).then(t=>{console.log("result === ",t),t.isExist?(this.handleData.user=t.data,this.currentUser=this.handleData.user,console.log("currentUser === ",this.currentUser),this.currentUserDocId=this.localStorageService.getItem("currentUserDocId")):console.log("User not found"),null!=this.currentUser.vehicle?(this.carDetails=this.currentUser.vehicle.vehicleList,console.log("this.carDetails === ",this.carDetails),this.vehicle=this.carDetails.length?this.carDetails[0].vehicleName:""):this.commonService.alertBox("Please create vehicle first","Vehicle error.",["Ok"])}).catch(t=>{console.error("Error:",t)})}onLocationsChanged(t){this.from=t.from,this.to=t.to,this.createRideForm.patchValue({from:this.from,to:this.to}),console.log("Locations changed:",this.from,this.to)}vehicles(){this.router.navigate(["/profile"])}setMinDate(){const t=new Date,n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();this.minDate=`${s}-${r}-${n}`}setDateToCurrent(){const t=new Date,n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();this.date=`${n}-${r}-${s}`,this.date=`${s}-${r}-${n}`;const l=String(t.getHours()).padStart(2,"0"),S=String(t.getMinutes()).padStart(2,"0");this.time=`${l}:${S}`}incseatAvl(){this.seatAvl<7&&this.seatAvl++}decseatAvl(){this.seatAvl>1&&this.seatAvl--}calculateDistance(){var t=this;return(0,_.A)(function*(){t.from&&t.to&&(yield(new google.maps.DistanceMatrixService).getDistanceMatrix({origins:[t.from],destinations:[t.to],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC},(r,s)=>{if(s===google.maps.DistanceMatrixStatus.OK){console.log("response === ",r);const l=r.rows[0].elements[0];console.log("element === ",l),t.rideDistance=l.distance.text,t.rideDuration=l.duration.text,console.log(`Distance from ${t.from} to ${t.to} is ${t.rideDistance} and will take approximately ${t.rideDuration}.`)}else console.error("Error fetching distance matrix:",s)}))})()}onVehicleChange(t){console.log("Selected vehicle:",t),this.vehicle=t}onCreateRide(){var t=this;return(0,_.A)(function*(){var n,r;if(t.currentUser)if(console.log("onCreateRide === "),t.currentUser.ride.lastride.id=(Math.floor(9e5*Math.random())+1e5).toString(),t.currentUser.ride.lastride.ridername=t.currentUser.userName,t.currentUser.ride.lastride.riderpicture=t.currentUser.profilePicture,t.currentUser.ride.lastride.riderEmail=t.currentUser.userEmail,t.currentUser.ride.lastride.riderUserId=t.currentUserDocId,t.currentUser.ride.lastride.type=t.rideCreatedBy,t.currentUser.ride.lastride.time=t.time,t.currentUser.ride.lastride.from=null!==(n=t.from)&&void 0!==n?n:"",t.currentUser.ride.lastride.to=null!==(r=t.to)&&void 0!==r?r:"",t.currentUser.ride.lastride.date=t.date,t.currentUser.ride.lastride.seatAvl=t.seatAvl.toString(),t.currentUser.ride.lastride.price=t.price.toString(),t.currentUser.ride.lastride.companionNames=t.companionNames,t.currentUser.ride.lastride.distance=t.rideDistance.toString(),t.currentUser.ride.lastride.duration=t.rideDuration.toString(),t.currentUser.ride.lastride.status="created",t.currentUser.ride.lastride.vehicle=t.vehicle,"driver"===t.rideCreatedBy){t.currentUser.ride.lastride.companionNames="this is driver ride";const s=Object.freeze({...t.currentUser.ride.lastride});console.log("immutableride === ",s),t.currentUser.ride.rideList.unshift(s),t.handleData.updateDocumentField(t.currentUserDocId,"ride",t.currentUser.ride),t.time="",t.from="",t.to="",t.date="",t.seatAvl=1,t.price=0,t.companionNames=""}else{t.currentUser.ride.lastride.price="00";const s=Object.freeze({...t.currentUser.ride.lastride});t.currentUser.ride.rideList.unshift(s),t.handleData.updateDocumentField(t.currentUserDocId,"ride",t.currentUser.ride),t.time="",t.from="",t.to="",t.date="",t.seatAvl=1,t.price=0,t.companionNames=""}})()}}return(i=m).\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(a.ok))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["app-create-ride"]],standalone:!0,features:[e.\u0275\u0275ProvidersFeature([u.GooglePlaceModule]),e.\u0275\u0275StandaloneFeature],decls:39,vars:17,consts:[["companionText",""],[3,"translucent"],["slot","start"],[1,"ion-padding","rideDetails"],[3,"ngSubmit","formGroup"],["formControlName","rideType"],["value","driver","aria-label","As a Driver"],["value","companion","aria-label","As a Companion"],["size","12",1,"tofrom"],[3,"locationsChanged","from","to"],["size","12",1,"dateTime"],[1,"custom-date-container"],["type","date","formControlName","date",1,"date","formInput",3,"ngModelChange","ngModel","min"],[1,"custom-time-container"],["type","time","formControlName","time",1,"time","formInput",3,"ngModelChange","ngModel"],["size","12",1,"seatAvl","formInput"],[4,"ngIf","ngIfElse"],["type","number","formControlName","seatAvl",3,"ngModelChange","ngModel"],[1,"decBtn",3,"click","disabled"],[3,"click","disabled"],["size","12","class","price formInput",4,"ngIf"],["size","12","class","companionNames formInput",4,"ngIf"],["size","12",4,"ngIf"],["size","12","class","companionNames",4,"ngIf"],["size","12",1,"submit"],["expand","block","type","submit",1,"primary",3,"disabled"],["size","12",1,"price","formInput"],["type","number","formControlName","price",3,"ngModelChange","ngModel"],["size","12",1,"companionNames","formInput"],["type","text","placeholder","companion names","formControlName","companionNames",3,"ngModelChange","ngModel"],["size","12"],["formControlName","vehicle",1,"dropdown",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["size","12",1,"companionNames"],[1,"errorHere",3,"click"],[1,"arrow"]],template:function(t,n){if(1&t){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.\u0275\u0275element(3,"ion-menu-button"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-title"),e.\u0275\u0275text(5,"Create Your Ride"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(6,"ion-content",3)(7,"form",4),e.\u0275\u0275listener("ngSubmit",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275resetView(n.onCreateRide())}),e.\u0275\u0275elementStart(8,"ion-row")(9,"ion-col")(10,"ion-radio-group",5)(11,"ion-radio",6),e.\u0275\u0275text(12,"As a Driver"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"ion-radio",7),e.\u0275\u0275text(14,"As a Companion"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(15,"ion-col",8)(16,"app-travel-from-to",9),e.\u0275\u0275listener("locationsChanged",function(l){return e.\u0275\u0275restoreView(r),e.\u0275\u0275resetView(n.onLocationsChanged(l))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"ion-col",10)(18,"div",11)(19,"input",12),e.\u0275\u0275twoWayListener("ngModelChange",function(l){return e.\u0275\u0275restoreView(r),e.\u0275\u0275twoWayBindingSet(n.date,l)||(n.date=l),e.\u0275\u0275resetView(l)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"div",13)(21,"input",14),e.\u0275\u0275twoWayListener("ngModelChange",function(l){return e.\u0275\u0275restoreView(r),e.\u0275\u0275twoWayBindingSet(n.time,l)||(n.time=l),e.\u0275\u0275resetView(l)}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"ion-col",15),e.\u0275\u0275template(23,P,2,0,"p",16)(24,D,2,0,"ng-template",null,0,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(26,"input",17),e.\u0275\u0275twoWayListener("ngModelChange",function(l){return e.\u0275\u0275restoreView(r),e.\u0275\u0275twoWayBindingSet(n.seatAvl,l)||(n.seatAvl=l),e.\u0275\u0275resetView(l)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"div")(28,"ion-button",18),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275resetView(n.decseatAvl())}),e.\u0275\u0275text(29,"-"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"ion-button",19),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275resetView(n.incseatAvl())}),e.\u0275\u0275text(31,"+"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(32,y,6,1,"ion-col",20)(33,O,2,1,"ion-col",21)(34,x,3,2,"ion-col",22)(35,E,5,0,"ion-col",23),e.\u0275\u0275elementStart(36,"ion-col",24)(37,"ion-button",25),e.\u0275\u0275text(38,"Create Ride"),e.\u0275\u0275elementEnd()()()()()}if(2&t){const r=e.\u0275\u0275reference(25);e.\u0275\u0275property("translucent",!0),e.\u0275\u0275advance(7),e.\u0275\u0275property("formGroup",n.createRideForm),e.\u0275\u0275advance(9),e.\u0275\u0275property("from",n.from)("to",n.to),e.\u0275\u0275advance(3),e.\u0275\u0275twoWayProperty("ngModel",n.date),e.\u0275\u0275property("min",n.minDate),e.\u0275\u0275advance(2),e.\u0275\u0275twoWayProperty("ngModel",n.time),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","driver"===n.rideCreatedBy)("ngIfElse",r),e.\u0275\u0275advance(3),e.\u0275\u0275twoWayProperty("ngModel",n.seatAvl),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",n.seatAvl<=1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",n.seatAvl>=7),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","driver"===n.rideCreatedBy),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","driver"!==n.rideCreatedBy),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","driver"===n.rideCreatedBy&&(null==n.carDetails?null:n.carDetails.length)>0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","driver"===n.rideCreatedBy&&(null==n.carDetails?null:n.carDetails.length)<1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",n.createRideForm.invalid)}},dependencies:[c.hU,c.QW,c.MC,c.KO,c.f0,c.Jm,c.ln,c.W9,c.eU,c.BC,c.ai,g.MD,g.Sq,g.bT,a.YN,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,h.N,a.X1,a.j4,a.JD],styles:[".rideDetails[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:450px;margin:auto}.rideDetails[_ngcontent-%COMP%]   .formInput[_ngcontent-%COMP%]{border:2px solid #BAD4DA;padding:.6rem 1rem;border-radius:15px;color:#000;background:#ddf7f7b3}.rideDetails[_ngcontent-%COMP%]   .formInput[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;max-width:-webkit-fill-available;padding:0;margin:0;border:none}.rideDetails[_ngcontent-%COMP%]   .tofrom[_ngcontent-%COMP%]{margin:auto}.rideDetails[_ngcontent-%COMP%]   .dateTime[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:auto;margin-top:1rem;gap:1rem}.rideDetails[_ngcontent-%COMP%]   .seatAvl[_ngcontent-%COMP%]{margin:auto;margin-top:1rem;display:flex;gap:.5rem;align-items:center}.rideDetails[_ngcontent-%COMP%]   .seatAvl[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;text-align:left;max-width:130px;padding:0;margin:0;border:none}.rideDetails[_ngcontent-%COMP%]   .seatAvl[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: transparent;--box-shadow: none;color:#000}.rideDetails[_ngcontent-%COMP%]   .seatAvl[_ngcontent-%COMP%]   .decBtn[_ngcontent-%COMP%]{border-right:4px solid white}.rideDetails[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{margin:auto;margin-top:1rem;display:flex;gap:.5rem;align-items:center}.rideDetails[_ngcontent-%COMP%]   .companionNames[_ngcontent-%COMP%]{margin-top:1rem}.rideDetails[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .rideDetails[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.rideDetails[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.rideDetails[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible{outline:none;--border-bottom: 2px solid blue}.rideDetails[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{margin-top:1rem}  p{margin:0!important}ion-radio-group[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin:auto;margin-bottom:2rem}ion-radio[_ngcontent-%COMP%]::part(container){width:30px;height:30px;position:absolute;left:-2.5rem;border-radius:8px;border:2px solid #ddd}ion-radio[_ngcontent-%COMP%]::part(mark){background:none;transition:none;transform:none;border-radius:0}ion-radio.radio-checked[_ngcontent-%COMP%]::part(container){background:green;position:absolute;left:-2.5rem;border-color:transparent}ion-radio.radio-checked[_ngcontent-%COMP%]::part(mark){width:6px;height:10px;border-width:0px 2px 2px 0px;border-style:solid;border-color:#fff;transform:rotate(45deg)}@media screen and (max-width: 424px){.seatAvl[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:80px!important}.price[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:7.8rem!important}}.errorHere[_ngcontent-%COMP%]{color:red;padding:0;display:flex;align-items:center;justify-content:center;gap:1rem;border-bottom:2px solid}.errorHere[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:2rem}.dropdown[_ngcontent-%COMP%]{border:2px solid #BAD4DA;padding:.6rem;background:#ddf7f7b3;margin-top:1rem;width:100%;color:#000;border-radius:15px}"]}),m})()}}]);