"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[457],{457:(D,m,i)=>{i.r(m),i.d(m,{FeedbackPage:()=>E});var e=i(3953),d=i(177),l=i(4341),r=i(1019),f=i(8986),g=i(2672),u=i(9520),_=i(3724);function h(a,s){if(1&a){const c=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",19)(1,"ion-icon",20),e.\u0275\u0275listener("click",function(){const t=e.\u0275\u0275restoreView(c).index,o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onStarClick(t))}),e.\u0275\u0275elementEnd()()}if(2&a){const c=s.index,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275classProp("ratingColor",n.filledStars[c]),e.\u0275\u0275property("name",n.filledStars[c]?"star":"star-outline")}}function b(a,s){1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"b"),e.\u0275\u0275text(2,"EXCELLENT"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function p(a,s){1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"b"),e.\u0275\u0275text(2,"GOOD"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function k(a,s){1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"b"),e.\u0275\u0275text(2,"NEUTRAL"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function v(a,s){1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"b"),e.\u0275\u0275text(2,"BAD"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function F(a,s){1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"b"),e.\u0275\u0275text(2,"WORST"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}let E=(()=>{var a;class s{constructor(n){this.FormBuilder=n,this.handleData=(0,e.inject)(f.K),this.router=(0,e.inject)(_.Ix),this.localStorageService=(0,e.inject)(g.s),this.commonService=(0,e.inject)(u.h),this.email=this.commonService.currentUserEmail,this.users=[],this.stars=[1,2,3,4,5],this.filledStars=[!1,!1,!1,!1,!1],this.feedbackFields={lastFeedback:{},feedbackList:[]},this.feedbackForm=this.FormBuilder.group({star:[0,l.k0.required],feedbackOptions:[[]],comment:[""]})}ngOnInit(){const n=this.router.getCurrentNavigation();var t;null!=n&&n.extras.state&&(this.matchedRideToDisplay=n.extras.state.matchedRideToDisplay,this.riderId=this.matchedRideToDisplay.riderUserId,this.driverData=n.extras.state.driverData,console.log("matchedRideToDisplay:",this.matchedRideToDisplay)),this.handleData.userExists(this.email).then(o=>{o.isExist?(this.handleData.user=o.data,console.log("this.handleData.user === ",this.handleData.user)):console.log("User not found")}).catch(o=>{console.error("Error:",o)}),null!=this.driverData.feedback?this.feedbackFields=null===(t=this.driverData)||void 0===t?void 0:t.feedback:this.handleData.updateDocumentField(this.riderId,"feedback",this.feedbackFields)}onStarClick(n){console.log("Star index:",n+1),this.star=n+1;for(let t=0;t<this.stars.length;t++)this.filledStars[n]=!0,this.filledStars[t]=t<=n;this.feedbackForm.patchValue({star:this.star})}submitFeedback(){console.log("Feedback submitted successfully"),console.log(this.feedbackForm.value);const n=this.feedbackForm.value,t=this.handleData.user;if(console.log("currentUser === ",t),t){const o={rideId:this.matchedRideToDisplay.id||"",userName:t.userName||"",email:this.email,star:n.star,feedbackDate:(new Date).toISOString(),feedbackDetails:n.feedbackOptions,comment:n.comment};console.log("this.feedbackFields.feedbackList === ",this.feedbackFields.feedbackList),this.feedbackFields&&(this.feedbackFields.lastFeedback=o),console.log("his.feedbackFields.lastFeedback === ",this.feedbackFields.lastFeedback),console.log("newFeedback === ",o),this.feedbackFields.feedbackList.unshift(o),console.log("this.feedbackFields.feedbackList === ",this.feedbackFields.feedbackList),console.log(" this.feedbackFields === ",this.feedbackFields);const S=this.localStorageService.getItem("currentUserDocId");console.log("Updated Current User:",t),console.log("currentUserDocId === ",S),this.handleData.updateDocumentField(this.riderId,"feedback",this.feedbackFields).then(()=>{console.log("Feedback updated successfully in Firebase."),this.router.navigate(["/welcome"])}).catch(C=>{console.error("Error updating feedback:",C)})}}onSkip(){this.router.navigate(["/welcome"])}}return(a=s).\u0275fac=function(n){return new(n||a)(e.\u0275\u0275directiveInject(l.ok))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-feedback"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:35,vars:9,consts:[[3,"translucent"],["slot","end",1,"skipBtn","ion-no-padding","ion-no-margin","ion-margin-end",3,"click"],[1,"ion-padding"],[3,"ngSubmit","formGroup"],[1,"ion-text-center","feedHeading"],[1,"ion-justify-content-center","starArea"],["class","w-fit",4,"ngFor","ngForOf"],[1,"ion-justify-content-center"],[4,"ngIf"],[1,"ion-margin-top"],["formControlName","feedbackOptions","label","Select Desired Feedback","label-placement","floating","fill","outline","multiple","true"],["value","rough driving"],["value","misbehave"],["value","drunk"],["value"," Good Driving"],["value","Good Behaviour"],[1,"ion-margin-vertical"],["formControlName","comment","label","Add a comment","labelPlacement","floating","rows","5","fill","outline","placeholder","Enter text"],["type","submit","expand","block",1,"primary",3,"disabled"],[1,"w-fit"],[3,"click","name"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-button",1),e.\u0275\u0275listener("click",function(){return t.onSkip()}),e.\u0275\u0275text(3," Skip>> "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-title"),e.\u0275\u0275text(5,"feedback"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(6,"ion-content",2)(7,"form",3),e.\u0275\u0275listener("ngSubmit",function(){return t.submitFeedback()}),e.\u0275\u0275elementStart(8,"p",4),e.\u0275\u0275text(9,"How was your ride?"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"ion-row",5),e.\u0275\u0275template(11,h,2,3,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"ion-row",7),e.\u0275\u0275template(13,b,3,0,"ng-container",8)(14,p,3,0,"ng-container",8)(15,k,3,0,"ng-container",8)(16,v,3,0,"ng-container",8)(17,F,3,0,"ng-container",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"ion-row",9)(19,"ion-select",10)(20,"ion-select-option",11),e.\u0275\u0275text(21,"Rough Driving"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"ion-select-option",12),e.\u0275\u0275text(23,"Misbehave"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"ion-select-option",13),e.\u0275\u0275text(25,"Drunk"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"ion-select-option",14),e.\u0275\u0275text(27,"Good Driving"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"ion-select-option",15),e.\u0275\u0275text(29,"Good Behaviour"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(30,"ion-row",16),e.\u0275\u0275element(31,"ion-textarea",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"ion-button",18)(33,"span"),e.\u0275\u0275text(34,"Submit"),e.\u0275\u0275elementEnd()()()()),2&n){let o;e.\u0275\u0275property("translucent",!0),e.\u0275\u0275advance(7),e.\u0275\u0275property("formGroup",t.feedbackForm),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",t.stars),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",5===t.star),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",4===t.star),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",3===t.star),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",2===t.star),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",1===t.star),e.\u0275\u0275advance(15),e.\u0275\u0275property("disabled",!(null!=(o=t.feedbackForm.get("star"))&&o.value)||(null==(o=t.feedbackForm.get("star"))?null:o.value)<0)}},dependencies:[r.nc,r.ln,r.Jm,r.iq,r.W9,r.eU,r.BC,r.ai,r.Nm,r.Ip,d.MD,d.Sq,d.bT,l.YN,l.qT,l.BC,l.cb,l.X1,l.j4,l.JD],styles:[".skipBtn[_ngcontent-%COMP%]{--background: none !important;--box-shadow: none !important;--color: black !important;text-transform:none!important}ion-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{max-width:450px;margin:auto}ion-content[_ngcontent-%COMP%]   .feedHeading[_ngcontent-%COMP%]{font-size:24px;font-weight:700}ion-content[_ngcontent-%COMP%]   .starArea[_ngcontent-%COMP%]{gap:1.5rem}ion-content[_ngcontent-%COMP%]   .starArea[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}ion-content[_ngcontent-%COMP%]   .starArea[_ngcontent-%COMP%]   .ratingColor[_ngcontent-%COMP%]{color:orange}ion-content[_ngcontent-%COMP%]   .feedbackSelect[_ngcontent-%COMP%]{min-height:73px}  .multiple-select-alert{--max-width: 80%}"]}),s})()}}]);