"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[716],{716:(ce,I,_)=>{_.r(I),_.d(I,{RideDetailViewPage:()=>le});var v=_(467),e=_(3953),S=_(177),b=_(4341),g=_(1019),P=_(3724),E=_(8986),L=_(2672),N=_(9520);let V=(()=>{var r;class u{constructor(){this.handleData=(0,e.inject)(E.K),this.localStorageService=(0,e.inject)(L.s),this.modalCtrl=(0,e.inject)(g.W3),this.alertCtrl=(0,e.inject)(g.hG)}ngOnInit(){console.log("currentRideData",this.currentRideData)}ionViewWillEnter(){this.email=this.currentRideData.riderEmail,this.price=this.currentRideData.price,this.seatAvl=this.currentRideData.seatAvl,this.time=this.currentRideData.time,console.log(" this.emai === ",this.email),this.handleData.userExists(this.email).then(i=>{i.isExist?(this.handleData.user=i.data,console.log("this.handleData.user === ",this.handleData.user),this.currentUserDocId=this.localStorageService.getItem("currentUserDocId"),this.currentUser=this.handleData.user):console.log("User not found")}).catch(i=>{console.error("Error:",i)})}updateRide(i){var t=this;return(0,v.A)(function*(){if(i.valid){if(t.price===t.currentRideData.price&&t.seatAvl===t.currentRideData.seatAvl&&t.time===t.currentRideData.time)return void(yield(yield t.alertCtrl.create({header:"No Changes Detected",message:"At least one field must be changed to update the ride.",buttons:["OK"],cssClass:"alertNofieldChanged"})).present());if(t.seatAvl&&t.seatAvl>6)return void(yield(yield t.alertCtrl.create({header:"Invalid Seat Number",message:"Seats must be less than 7.",buttons:["OK"],cssClass:"alertInvalidSeat"})).present());const o=t.currentRideData.id,c=t.currentUser.ride.rideList.find(p=>p.id===o);if(t.currentUser.userEmail===t.email)if(c){c.price=t.price,c.seatAvl=t.seatAvl,c.time=t.time;try{yield t.handleData.updateDocumentField(t.currentUserDocId,"ride",t.currentUser.ride),t.modalCtrl.dismiss({updatedRide:c})}catch(p){console.error("Error updating document:",p)}}else console.log("Element with id"+t.price+" not found");else console.log("ID not matched")}})()}closeModal(){this.modalCtrl.dismiss()}}return(r=u).\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-edit-ride"]],inputs:{currentRideData:"currentRideData"},standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:19,vars:4,consts:[["rideForm","ngForm"],["slot","end","color","none",1,"cancelBtn",3,"click"],["name","close","color","dark"],[1,"ion-padding-top",3,"ngSubmit"],["position","floating"],["type","number","name","price","required","",3,"ngModelChange","ngModel"],["type","number","min","1","max","6","name","seatAvl","required","",3,"ngModelChange","ngModel"],["type","time","name","time","required","",3,"ngModelChange","ngModel"],["expand","full","type","submit",1,"success",3,"disabled"]],template:function(i,t){if(1&i){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-button",1),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(n),e.\u0275\u0275resetView(t.closeModal())}),e.\u0275\u0275element(1,"ion-icon",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"ion-content")(3,"form",3,0),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275reference(4);return e.\u0275\u0275resetView(t.updateRide(s))}),e.\u0275\u0275elementStart(5,"ion-item")(6,"ion-label",4),e.\u0275\u0275text(7,"Price"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"ion-input",5),e.\u0275\u0275twoWayListener("ngModelChange",function(s){return e.\u0275\u0275restoreView(n),e.\u0275\u0275twoWayBindingSet(t.price,s)||(t.price=s),e.\u0275\u0275resetView(s)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"ion-item")(10,"ion-label",4),e.\u0275\u0275text(11,"Seat Availability"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"ion-input",6),e.\u0275\u0275twoWayListener("ngModelChange",function(s){return e.\u0275\u0275restoreView(n),e.\u0275\u0275twoWayBindingSet(t.seatAvl,s)||(t.seatAvl=s),e.\u0275\u0275resetView(s)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"ion-item")(14,"ion-label",4),e.\u0275\u0275text(15,"Time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"ion-input",7),e.\u0275\u0275twoWayListener("ngModelChange",function(s){return e.\u0275\u0275restoreView(n),e.\u0275\u0275twoWayBindingSet(t.time,s)||(t.time=s),e.\u0275\u0275resetView(s)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"ion-button",8),e.\u0275\u0275text(18,"Submit"),e.\u0275\u0275elementEnd()()()}if(2&i){const n=e.\u0275\u0275reference(4);e.\u0275\u0275advance(8),e.\u0275\u0275twoWayProperty("ngModel",t.price),e.\u0275\u0275advance(4),e.\u0275\u0275twoWayProperty("ngModel",t.seatAvl),e.\u0275\u0275advance(4),e.\u0275\u0275twoWayProperty("ngModel",t.time),e.\u0275\u0275advance(),e.\u0275\u0275property("disabled",!n.form.valid)}},dependencies:[g.iq,g.Jm,g.$w,g.uz,g.he,g.W9,b.YN,b.qT,b.BC,b.cb,b.YS,b.vS,b.cV],styles:[".cancelBtn[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;--box-shadow: none;position:absolute;right:.2rem;top:.2rem;z-index:1}.cancelBtn[_ngcontent-%COMP%]:focus-visible{--box-shadow: none}  .alertInvalidSeat,   .alertNofieldChanged{--max-width: 355px}"]}),u})();const F=(0,_(5083).F3)("Geolocation",{web:()=>_.e(920).then(_.bind(_,2920)).then(r=>new r.GeolocationWeb)}),k=(r,u,a,i,t,n)=>({requestedCss:r,createdCss:u,acceptedCss:a,ongoingCss:i,completedCss:t,canceledCss:n}),A=()=>[];function B(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"div",19)(1,"b"),e.\u0275\u0275text(2,"Companions Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.companionNames)}}function j(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Requested "),e.\u0275\u0275elementEnd())}function z(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"created "),e.\u0275\u0275elementEnd())}function W(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Accepted"),e.\u0275\u0275elementEnd())}function q(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Ongoing"),e.\u0275\u0275elementEnd())}function H(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Completed"),e.\u0275\u0275elementEnd())}function G(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Cancelled"),e.\u0275\u0275elementEnd())}function J(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Cancelled"),e.\u0275\u0275elementEnd())}function Y(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label"),e.\u0275\u0275text(1,"Rejected"),e.\u0275\u0275elementEnd())}function K(r,u){if(1&r){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"ion-buttons",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(t.editRide())}),e.\u0275\u0275elementStart(2,"ion-button",41),e.\u0275\u0275text(3," Edit "),e.\u0275\u0275element(4,"ion-icon",42),e.\u0275\u0275elementEnd()()()}if(2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",a.showEditBtn)}}function Q(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.riderEmail," ")}}function X(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.riderEmail," ")}}function Z(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43),e.\u0275\u0275text(1," Confirm phone number "),e.\u0275\u0275elementEnd())}function $(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",a.rideCreator.phone," ")}}function ee(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43),e.\u0275\u0275text(1," No Rating Yet "),e.\u0275\u0275elementEnd())}function te(r,u){if(1&r&&e.\u0275\u0275element(0,"ion-icon",47),2&r){const a=u.index,i=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("name",a<i.RoundOfStar?"star":"star-outline")}}function ie(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-label",43)(1,"div",44),e.\u0275\u0275element(2,"ion-icon",45),e.\u0275\u0275template(3,te,1,1,"ion-icon",46),e.\u0275\u0275elementEnd()()),2&r&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(1,A).constructor(5)))}function ne(r,u){if(1&r){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-row",4)(1,"ion-col",50)(2,"p"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"ion-col",50)(5,"ion-button",51),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext().index,n=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(n.acceptRejectRequest(t,["accept"]))}),e.\u0275\u0275elementStart(6,"span"),e.\u0275\u0275text(7,"Accept"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"ion-col",50)(9,"ion-button",52),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext().index,n=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(n.acceptRejectRequest(t,["reject"]))}),e.\u0275\u0275elementStart(10,"span"),e.\u0275\u0275text(11,"Reject"),e.\u0275\u0275elementEnd()()()()}if(2&r){const a=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a.passName)}}function ae(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,ne,12,1,"ion-row",49),e.\u0275\u0275elementEnd()),2&r){const a=u.$implicit;e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","Requested"===a.passStatus)}}function re(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"ion-card")(1,"ion-col",5)(2,"p"),e.\u0275\u0275text(3,"Passanger request list"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(4,ae,2,1,"div",48),e.\u0275\u0275elementEnd()),2&r){const a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.passengerList)}}function oe(r,u){1&r&&(e.\u0275\u0275elementStart(0,"ion-button",53)(1,"span"),e.\u0275\u0275text(2,"Cancel Ride"),e.\u0275\u0275elementEnd()())}function se(r,u){if(1&r){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",54)(1,"h4"),e.\u0275\u0275text(2,"Are you sure you want to cancel the ride? This action is not reversible!"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"ion-row")(4,"ion-col")(5,"ion-item",55),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(!1===t.showpassengerList?t.cancelRide():t.cancelByDriver())}),e.\u0275\u0275elementStart(6,"ion-label",54),e.\u0275\u0275text(7,"Yes"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"ion-col")(9,"ion-item",56),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a),e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(133);return e.\u0275\u0275resetView(t.dismiss())}),e.\u0275\u0275elementStart(10,"ion-label",54),e.\u0275\u0275text(11,"No"),e.\u0275\u0275elementEnd()()()()()}}function de(r,u){if(1&r){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-content")(1,"ion-card")(2,"ion-row",4)(3,"ion-col",5)(4,"p"),e.\u0275\u0275text(5,"Ride Route"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"p")(7,"b"),e.\u0275\u0275text(8,"Ride Id :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"ion-col",6)(11,"div",7)(12,"div",8)(13,"div",9),e.\u0275\u0275element(14,"img",10)(15,"img",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",12)(17,"b",13),e.\u0275\u0275text(18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"p")(20,"b"),e.\u0275\u0275text(21),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(22,"ion-col",14)(23,"div",7)(24,"div",15)(25,"div",16),e.\u0275\u0275element(26,"img",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"b",12),e.\u0275\u0275text(28),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(29,"ion-col",18)(30,"div",19)(31,"b"),e.\u0275\u0275text(32,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"p"),e.\u0275\u0275text(34),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(35,"div",19)(36,"b"),e.\u0275\u0275text(37,"Time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"p"),e.\u0275\u0275text(39),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(40,"div",19)(41,"b"),e.\u0275\u0275text(42,"Seat"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"p"),e.\u0275\u0275text(44),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(45,"div",19)(46,"b"),e.\u0275\u0275text(47,"Price"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"p"),e.\u0275\u0275text(49),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(50,B,5,1,"div",20),e.\u0275\u0275elementStart(51,"div",19)(52,"b"),e.\u0275\u0275text(53,"Ride status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(54,"p",21),e.\u0275\u0275elementContainerStart(55,22),e.\u0275\u0275template(56,j,2,0,"ion-label",23)(57,z,2,0,"ion-label",23)(58,W,2,0,"ion-label",23)(59,q,2,0,"ion-label",23)(60,H,2,0,"ion-label",23)(61,G,2,0,"ion-label",23)(62,J,2,0,"ion-label",23)(63,Y,2,0,"ion-label",23),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(64,"div",19)(65,"b"),e.\u0275\u0275text(66,"Transaction Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(67,"p"),e.\u0275\u0275text(68,"Paid"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(69,"div",19)(70,"b"),e.\u0275\u0275text(71,"Total distance traveled"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(72,"p"),e.\u0275\u0275text(73,"custom 25km"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(74,"div",19)(75,"b"),e.\u0275\u0275text(76,"Total traveled duration"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(77,"p"),e.\u0275\u0275text(78,"custom 2 hr"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(79,"div",19)(80,"b"),e.\u0275\u0275text(81,"Resolution Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(82,"p"),e.\u0275\u0275text(83,"Flag raised pending / solved / resolved by admin"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(84,K,5,1,"div",24),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(85,"ion-card")(86,"ion-row",4)(87,"ion-col",5)(88,"p"),e.\u0275\u0275text(89,"Driver Details"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(90,"ion-col",6)(91,"p",25),e.\u0275\u0275element(92,"img",26),e.\u0275\u0275elementStart(93,"b"),e.\u0275\u0275text(94),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(95,"ion-col",27)(96,"ion-item",28),e.\u0275\u0275element(97,"ion-icon",29),e.\u0275\u0275template(98,Q,2,1,"ion-label",30)(99,X,2,1,"ion-label",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(100,"ion-item",28),e.\u0275\u0275element(101,"ion-icon",29),e.\u0275\u0275template(102,Z,2,0,"ion-label",30)(103,$,2,1,"ion-label",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(104,"ion-item",28),e.\u0275\u0275template(105,ee,2,0,"ion-label",30)(106,ie,4,2,"ion-label",30),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(107,re,5,1,"ion-card",3),e.\u0275\u0275elementStart(108,"ion-card",31)(109,"ion-row",4)(110,"ion-col",5)(111,"p"),e.\u0275\u0275text(112,"Ride Activity"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(113,"ion-col",6)(114,"div")(115,"ion-buttons",32)(116,"ion-button",33),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(!1===t.showpassengerList?t.startStopByPassNotification(["start"]):t.startStopRideByDriverNotification(["start"]))}),e.\u0275\u0275text(117," Start Ride "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(118,"div")(119,"ion-buttons",32)(120,"ion-button",33),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(!1===t.showpassengerList?t.startStopByPassNotification(["stop"]):t.startStopRideByDriverNotification(["stop"]))}),e.\u0275\u0275text(121," Stop Ride "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(122,"div")(123,"ion-buttons",32)(124,"ion-button",34),e.\u0275\u0275text(125," Discrepancy Flag "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(126,"div")(127,"ion-buttons",32)(128,"ion-button",34),e.\u0275\u0275text(129," Pilot Agreement Companion Agreement "),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(130,"div",35),e.\u0275\u0275template(131,oe,3,0,"ion-button",36),e.\u0275\u0275elementStart(132,"ion-modal",37,0),e.\u0275\u0275template(134,se,12,0,"ng-template"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(135,"div",38)(136,"ion-button",39),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const t=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(t.bookRide())}),e.\u0275\u0275elementStart(137,"span"),e.\u0275\u0275text(138,"Book Ride"),e.\u0275\u0275elementEnd()()()()}if(2&r){const a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(9),e.\u0275\u0275textInterpolate1(" ",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.id," "),e.\u0275\u0275advance(9),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.from),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2("",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.distance,", ",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.duration,""),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.to),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.date),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.time),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.seatAvl),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.price),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","this is driver ride"!==(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.companionNames)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction6(36,k,"Requested"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),"created"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),"accepted"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),"ongoing"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),"completed"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),"cancelled"===(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status))),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitch",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.status),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","Requested"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","created"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","accepted"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","ongoing"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","completed"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","cancelled"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","RideCancelledByDriver"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngSwitchCase","rejected"),e.\u0275\u0275advance(21),e.\u0275\u0275property("ngIf",a.showpassengerList),e.\u0275\u0275advance(8),e.\u0275\u0275property("src",null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.riderpicture,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(null==a.matchedRideToDisplay?null:a.matchedRideToDisplay.ridername),e.\u0275\u0275advance(3),e.\u0275\u0275property("color",null!=a.matchedRideToDisplay&&a.matchedRideToDisplay.riderEmail?"success":"medium")("name",null!=a.matchedRideToDisplay&&a.matchedRideToDisplay.riderEmail?"checkmark-circle-outline":"add-circle-outline"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!a.isEmailVerified),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",a.isEmailVerified),e.\u0275\u0275advance(2),e.\u0275\u0275property("color",a.isPhoneVerified?"success":"medium")("name",a.isPhoneVerified?"checkmark-circle-outline":"add-circle-outline"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!a.isPhoneVerified),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",a.isPhoneVerified),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",0===a.averageStars||void 0===a.averageStars),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",a.averageStars),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",a.showpassengerList),e.\u0275\u0275advance(24),e.\u0275\u0275property("ngIf",!0===a.showpassengerList||!1===a.showpassengerList),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",a.disableBookButton())}}let le=(()=>{var r;class u{constructor(i,t){this.route=i,this.datePipe=t,this.handleData=(0,e.inject)(E.K),this.localStorageService=(0,e.inject)(L.s),this.commonService=(0,e.inject)(N.h),this.modalCtrl=(0,e.inject)(g.W3),this.isEmailVerified=!1,this.isPhoneVerified=!1,this.bookRideBtn=!1,this.showpassengerList=!1,this.showEditBtn=!1,this.router=(0,e.inject)(P.Ix),this.users=[]}ngOnInit(){var i=this;return(0,v.A)(function*(){try{i.route.queryParams.subscribe(t=>{t.ride&&(i.ride=JSON.parse(t.ride),console.log("Ride Data:",i.ride),i.initializeRideData())}),i.email=i.commonService.currentUserEmail,yield i.loadUserData(i.email),yield i.loadRideCreatorData(i.rideremail),i.waitForCurrentUserDocId()}catch(t){console.error("Initialization error:",t)}})()}initializeRideData(){this.rideremail=this.ride.riderEmail,this.rideCreatorDocId=this.ride.riderUserId,this.currentRideId=this.ride.id,this.status=this.ride.status,console.log("Ride Status:",this.status),console.log("Rider User ID:",this.ride.riderUserId)}loadUserData(i){var t=this;return(0,v.A)(function*(){try{const n=yield t.handleData.userExists(i);n.isExist?(t.handleData.user=n.data,t.currentUser=t.handleData.user,t.currentUserDocId=t.localStorageService.getItem("currentUserDocId"),console.log("Current User Data:",t.currentUser),t.isEmailVerified=t.matchedRideToDisplay.email_verified,t.userRideList=t.handleData.getAllRideLists(),t.averageStars=t.calculateAverageStars(t.currentUser.feedback.feedbackList),t.RoundOfStar=Math.round(t.averageStars),console.log("Current User Average Stars:",t.RoundOfStar)):console.log("User not found")}catch(n){console.error("Error loading user data:",n)}})()}loadRideCreatorData(i){var t=this;return(0,v.A)(function*(){try{const n=yield t.handleData.userExists(i,!1);n.isExist?(t.handleData.user=n.data,t.rideCreator=t.handleData.user,t.isPhoneVerified=t.rideCreator.phone,console.log("Ride Creator Data:",t.rideCreator),t.averageStars=t.calculateAverageStars(t.rideCreator.feedback.feedbackList),t.RoundOfStar=Math.round(t.averageStars),console.log("Ride creator Average Stars:",t.RoundOfStar)):console.log("Ride creator not found")}catch(n){console.error("Error loading ride creator data:",n)}})()}calculateAverageStars(i){const t=i.reduce((n,d)=>n+d.star,0);return i.length?t/i.length:0}waitForCurrentUserDocId(){var i=this;return(0,v.A)(function*(){for(;void 0===i.currentUserDocId;)yield new Promise(t=>setTimeout(t,100));i.checkshowpassengerList(),i.findMatchedRideToDisplay()})()}checkshowpassengerList(){this.currentUserDocId===this.ride.riderUserId&&(this.showpassengerList=!0)}disableBookButton(){const i=this.currentUserDocId===this.ride.riderUserId,t=this.currentUser.ride.rideList.some(n=>"accepted"===n.status||"RideStarted"===n.status||"Requested"===n.status);return i||t}findMatchedRideToDisplay(){const i=this.currentUser.ride.rideList.find(t=>t.id===this.currentRideId);console.log("displayMatchedRide === ",i),null!=i?(this.matchedRideToDisplay=i,console.log("this.matchedRideToDisplay === ",this.matchedRideToDisplay),this.selectedRidePassengerList=this.matchedRideToDisplay.passengerList):(this.matchedRideToDisplay=this.ride,console.log("this.matchedRideToDisplay === ",this.matchedRideToDisplay),this.selectedRidePassengerList=this.matchedRideToDisplay.passengerList)}bookRide(){var i=this;return(0,v.A)(function*(){const t=i.rideCreator.ride.rideList.find(d=>d.id===i.currentRideId);console.log("matchedRide === ",t);const n=i.currentUser.ride.rideList.find(d=>d.id===i.currentRideId);if(console.log("rideinCurrentUserRideList === ",n),t){if(null==n){console.log("current user ki ridelist me ride nhi thi, add ho gyii");const d=t.passengerList,s=t.status;t.status="Requested",t.passengerList=[],i.currentUser.ride.rideList.unshift(i.handleData.clone(t)),i.handleData.updateDocumentField(i.currentUserDocId,"ride",i.currentUser.ride),t.status=s,t.passengerList=d}if(i.bookRideBtn=!0,null!=i.ride.passengerList){console.log("passenger h ");const d=i.rideCreator.ride.rideList.findIndex(c=>c.id===i.currentRideId);console.log("rideIndex === ",d),console.log("current ride === ",i.rideCreator.ride.rideList[d]);const s=i.rideCreator.ride.rideList[d].passengerList;console.log("currentRidePassangerList === ",s);let m=s.find(c=>c.passId===i.currentUserDocId);console.log("currentUserExistInPassList === ",m),console.log("this.rideCreator.notificationList === ",i.rideCreator.notificationList);const o={senderName:i.currentUser.userName,status:"Requested",message:"Requested a Ride",rideid:i.currentRideId,url:"notification",Ridedata:i.ride};if(null!=m)1==i.rideCreator.isNotification?i.rideCreator.notificationList.unshift(i.handleData.clone(o)):i.rideCreator.notificationList=[o],i.handleData.updateDocumentField(i.ride.riderUserId,"notificationList",i.rideCreator.notificationList),i.rideCreator.allNotification.unshift(i.handleData.clone(o)),i.handleData.updateDocumentField(i.ride.riderUserId,"allNotification",i.rideCreator.allNotification),m.passStatus="Requested",i.handleData.updateDocumentField(i.ride.riderUserId,"ride",i.rideCreator.ride),i.handleData.updateDocumentField(i.ride.riderUserId,"isNotification",!0);else{const p=Object.freeze({passName:i.currentUser.userName,passId:i.currentUserDocId,passEmail:i.currentUser.userEmail,passStatus:"Requested"});console.log("immutablePassenger === ",p),t.passengerList.unshift(p),console.log(" matchedRide.passengerList === ",t.passengerList),console.log("currentRidePassangerList  === ",s),i.currentUser.ride.rideList.find(f=>f.id===i.currentRideId).status="Requested",i.handleData.updateDocumentField(i.currentUserDocId,"ride",i.currentUser.ride),-1!==d?(1==i.rideCreator.isNotification?i.rideCreator.notificationList.unshift(i.handleData.clone(o)):i.rideCreator.notificationList=[o],i.rideCreator.allNotification.unshift(i.handleData.clone(o)),i.handleData.updateDocumentField(i.ride.riderUserId,"allNotification",i.rideCreator.allNotification),i.handleData.updateDocumentField(i.ride.riderUserId,"notificationList",i.rideCreator.notificationList),i.rideCreator.ride.rideList[d]=t,i.handleData.updateDocumentField(i.ride.riderUserId,"ride",i.rideCreator.ride),i.handleData.updateDocumentField(i.ride.riderUserId,"isNotification",!0)):console.log("Ride to replace not found!")}}else console.log("koi nhi h create kro")}else console.log("not able to book the ride")})()}cancelByDriver(){var i=this;return(0,v.A)(function*(){const t=i.rideCreator.ride.rideList.find(n=>n.id===i.currentRideId);if(console.log("matchedRide cancelByDriver wali === ",t),null!=t){t.status="RideCancelledByDriver",yield i.handleData.updateDocumentField(i.ride.riderUserId,"ride",i.rideCreator.ride);const n=t.passengerList;console.log("requestedPassengerList === ",n);for(let d=0;d<n.length;d++){const s=n[d].passId,m=n[d].passEmail,o=i.passengerData;try{const c=yield i.handleData.userExists(m,!1);if(c.isExist){if(i.handleData.user=c.data,i.passengerData=i.handleData.user,console.log("passengerData === "+d,i.passengerData),null!=i.passengerData){const p=i.passengerData.ride.rideList.find(l=>l.id===i.currentRideId);if(console.log("passengerMatchedRide cancelByDriver wali === ",p),null!=p){p.status="RideCancelledByDriver",yield i.handleData.updateDocumentField(s,"ride",i.passengerData.ride);const l={senderName:i.currentUser.userName,status:"cancelled",message:"cancelled a Ride",rideid:i.currentRideId,url:"notification",Ridedata:i.ride};1==i.passengerData.isNotification?i.passengerData.notificationList.unshift(i.handleData.clone(l)):i.passengerData.notificationList=[l],i.passengerData.allNotification.unshift(i.handleData.clone(l)),i.handleData.updateDocumentField(s,"allNotification",i.passengerData.allNotification),i.handleData.updateDocumentField(s,"notificationList",i.passengerData.notificationList),i.handleData.updateDocumentField(s,"isNotification",!0)}}}else console.log("User not found")}catch(c){console.error("Error:",c)}i.passengerData=o}}})()}cancelRide(){var i=this;return(0,v.A)(function*(){const t=i.rideCreator.ride.rideList.find(s=>s.id===i.currentRideId);console.log("matchedRide cancel wali === ",t);const n=i.currentUser.ride.rideList.find(s=>s.id===i.currentRideId);console.log("matchedRideInCurrentUserList === ",n),null!=n&&(n.status="cancelled",i.handleData.updateDocumentField(i.currentUserDocId,"ride",i.currentUser.ride));const d={senderName:i.currentUser.userName,status:"cancelled",message:"cancelled a Ride",rideid:i.currentRideId,url:"notification",Ridedata:i.ride};if(t){const s=i.handleData.clone(t.passengerList);console.log("matchRidePassList cancel wali === ",s);const m=s.find(o=>o.passId===i.currentUserDocId);if(console.log("currentUserExistInPassList cancel wali === ",m),m){const o=s.filter(c=>c.passId!==i.currentUserDocId);1==i.rideCreator.isNotification?i.rideCreator.notificationList.unshift(i.handleData.clone(d)):i.rideCreator.notificationList=[d],i.rideCreator.allNotification.unshift(i.handleData.clone(d)),i.handleData.updateDocumentField(i.ride.riderUserId,"allNotification",i.rideCreator.allNotification),i.handleData.updateDocumentField(i.ride.riderUserId,"notificationList",i.rideCreator.notificationList),t.passengerList=i.handleData.clone(o),i.handleData.updateDocumentField(i.ride.riderUserId,"ride",i.rideCreator.ride),i.handleData.updateDocumentField(i.ride.riderUserId,"isNotification",!0)}}i.modalCtrl.dismiss()})()}editRide(){var i=this;return(0,v.A)(function*(){const t=yield i.modalCtrl.create({component:V,cssClass:["editRideModalCss"],componentProps:{currentRideData:i.ride}});t.onDidDismiss().then(n=>{n.data&&n.data.updatedRide&&(i.ride=n.data.updatedRide,console.log("Updated Ride Data:",i.ride),i.calculateTotalPrice())}),t.present()})()}acceptRejectRequest(i,t){var n=this;return(0,v.A)(function*(){const d=n.selectedRidePassengerList[i];console.log("selectedPass === ",d),n.passId=d.passId,n.passEmail=d.passEmail;const s=t[0];if(console.log("buttonType === ",s),!n.passData)try{const o=yield n.handleData.userExists(n.passEmail,!1);if(console.log("result=== ",o),!o.isExist)return void console.log("User not found");console.log("this.handleData.user === ",n.handleData.user),n.handleData.user=o.data,n.passData=n.handleData.user,console.log("this.passData === ",n.passData)}catch(o){return void console.error("Error:",o)}console.log("this.passData === ",n.passData);const m=n.rideCreator.ride.rideList.find(o=>o.id===n.currentRideId);if(console.log("matchedRide === ",m),m){const o=n.handleData.clone(m.passengerList);console.log("currentRidePassengerList === ",o);const c=o.find(p=>p.passId===n.passId);if(console.log("currentUserExistInPassList === ",c),c){const p=o.map(l=>{if(l.passId===n.passId){if("accept"==s){const f=n.passData.ride.rideList.find(h=>h.id===n.currentRideId);return console.log("matchedRideOfPerticularPassenger privous=== ",f),f.status="accepted",console.log("matchedRideOfPerticularPassenger === ",f),n.handleData.updateDocumentField(n.passId,"ride",n.passData.ride),{...l,passStatus:"accepted"}}if("reject"==s){const f=n.passData.ride.rideList.find(h=>h.id===n.currentRideId);return console.log("matchedRideOfPerticularPassenger privous=== ",f),f.status="rejected",console.log("matchedRideOfPerticularPassenger === ",f),n.handleData.updateDocumentField(n.passId,"ride",n.passData.ride),{...l,passStatus:"rejected"}}}return l});if(console.log("updatedPassengerList === ",p),m.passengerList=n.handleData.clone(p),yield n.handleData.updateDocumentField(n.ride.riderUserId,"ride",n.rideCreator.ride),"accept"==s){const l={senderName:n.currentUser.userName,status:"accepted",message:"accepted a Ride",rideid:n.currentRideId,url:"notification",Ridedata:n.ride};1==n.passData.isNotification?n.passData.notificationList.unshift(n.handleData.clone(l)):n.passData.notificationList=[l],n.passData.allNotification.unshift(n.handleData.clone(l)),n.handleData.updateDocumentField(n.passId,"allNotification",n.passData.allNotification)}else if("reject"==s){const l={senderName:n.currentUser.userName,status:"rejected",message:"rejected a Ride",rideid:n.currentRideId,url:"notification",Ridedata:n.ride};1==n.passData.isNotification?n.passData.notificationList.unshift(n.handleData.clone(l)):n.passData.notificationList=[l],n.passData.allNotification.unshift(n.handleData.clone(l)),n.handleData.updateDocumentField(n.passId,"allNotification",n.passData.allNotification)}yield n.handleData.updateDocumentField(n.passId,"notificationList",n.passData.notificationList),yield n.handleData.updateDocumentField(n.passId,"isNotification",!0)}}})()}calculateTotalPrice(){return console.log("this.ride.price * this.ride.seatAvl === ",this.ride.price*this.ride.seatAvl),this.ride.price*this.ride.seatAvl}ionViewWillEnter(){this.calculateTotalPrice()}dateFormat(i){const t=new Date(i);return`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]} ${t.getDate()} ${["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]}`}calculateEndTime(i){const t=i.time;console.log("time === ",t);const n=i.duration;console.log("duration === ",n);const[d,s]=t.split(":").map(Number),m=n.match(/(\d+)\s*day/),o=n.match(/(\d+)\s*hour/),c=n.match(/(\d+)\s*mins/),p=m?parseInt(m[1],10):0;let h=d+(o?parseInt(o[1],10):0),D=s+(c?parseInt(c[1],10):0),y=p;D>=60&&(D-=60,h+=1),h>=24&&(h-=24,y+=1);const C=h.toString().padStart(2,"0"),T=D.toString().padStart(2,"0");return y>0?`${y} day(s) ${C}:${T}`:`${C}:${T}`}timeStringToDate(i){const t=new Date,[n,d,s]=i.split(":").map(Number);return t.setHours(n,d,s,0),t}getCurrentLoc(){var i=this;return(0,v.A)(function*(){try{const t=yield F.getCurrentPosition({enableHighAccuracy:!0});console.log("Location retrieved successfully",t),console.log("Latitude:",t.coords.latitude),console.log("Longitude:",t.coords.longitude);const n=new google.maps.Geocoder,d={lat:t.coords.latitude,lng:t.coords.longitude};return new Promise((s,m)=>{n.geocode({location:d},(o,c)=>{"OK"===c?o&&o[0]?(i.currentLoc=o[0].formatted_address,console.log("Formatted Address (Current Location): ",i.currentLoc),s()):(console.log("No results found"),m("No results found")):(console.log("Geocoder failed due to: "+c),m("Geocoder failed due to: "+c))})})}catch(t){return console.error("Error retrieving location",t),Promise.reject(t)}})()}startStopRideByDriverNotification(i){var t=this;return(0,v.A)(function*(){try{yield t.getCurrentLoc();const o=t.rideCreator.ride.rideList.find(p=>p.id===t.currentRideId);console.log("matchedRide started  === ",o);const c=i[0];if(console.log("buttonType === ",c),null!=o){var n,d;const p=new Date,l=null!==(n=t.datePipe.transform(p,"HH:mm:ss"))&&void 0!==n?n:"",f=null!==(d=t.datePipe.transform(p,"yyyy-MM-dd"))&&void 0!==d?d:"";if(console.log("this.currentLoc === ",t.currentLoc),console.log("this.currentLoc === ",t.currentLoc),"start"===c)o.status="RideStarted",o.travelDetails.startlocation=t.currentLoc,console.log(" matchedRide.travelDetails.startlocation === ",o.travelDetails.startlocation),o.travelDetails.startTime=l,o.travelDetails.startDate=f;else{o.status="RideStopped",o.travelDetails.endTime=l;const D=t.timeStringToDate(o.travelDetails.startTime),C=t.timeStringToDate(o.travelDetails.endTime).getTime()-D.getTime(),T=Math.floor(C/36e5),x=Math.floor(C%36e5/6e4);console.log(`Time traveled: ${T} hours and ${x} minutes`),o.travelDetails.traveledTime=`${T} hours and ${x} minutes`}yield t.handleData.updateDocumentField(t.ride.riderUserId,"ride",t.rideCreator.ride);const h=o.passengerList;console.log("requestedPassengerList === ",h);for(let D=0;D<h.length;D++){const y=h[D].passId,C=h[D].passEmail,T=t.passengerData;if("start"===c){var s;o.status="RideStarted",o.travelDetails.startlocation=null!==(s=t.currentLoc)&&void 0!==s?s:"Unknown Location",o.travelDetails.startTime=l,o.travelDetails.startDate=f,h[D].passStatus="RideStarted"}else{var m;h[D].passStatus="RideStoped",o.travelDetails.endTime=l,o.travelDetails.endlocation=null!==(m=t.currentLoc)&&void 0!==m?m:"Unknown Location";const x=t.timeStringToDate(o.travelDetails.startTime),R=t.timeStringToDate(o.travelDetails.endTime).getTime()-x.getTime(),M=Math.floor(R/36e5),U=Math.floor(R%36e5/6e4);console.log(`Time traveled: ${M} hours and ${U} minutes`),o.travelDetails.traveledTime=`${M} hours and ${U} minutes`}t.handleData.updateDocumentField(t.ride.riderUserId,"ride",t.rideCreator.ride);try{const x=yield t.handleData.userExists(C,!1);if(x.isExist){if(t.handleData.user=x.data,t.passengerData=t.handleData.user,console.log("passengerData === "+D,t.passengerData),null!=t.passengerData){const w=t.passengerData.ride.rideList.find(R=>R.id===t.currentRideId);if(console.log("passengerMatchedRide cancelByDriver wali === ",w),null!=w){if(w.status="start"===c?"RideStarted":"RideStoped",yield t.handleData.updateDocumentField(y,"ride",t.passengerData.ride),"start"===c){const R={senderName:t.currentUser.userName,status:"Ride has Started",message:"Ride has begun so, sit back and relax, enjoy your ride",rideid:t.currentRideId,url:"notification",Ridedata:t.ride};1==t.passengerData.isNotification?t.passengerData.notificationList.unshift(t.handleData.clone(R)):t.passengerData.notificationList=[R],t.passengerData.allNotification.unshift(t.handleData.clone(R))}else{const R={senderName:t.currentUser.userName,status:"Ride has Stoped",message:"Ride is completed",rideid:t.currentRideId,url:"notification",Ridedata:t.ride};1==t.passengerData.isNotification?t.passengerData.notificationList.unshift(t.handleData.clone(R)):t.passengerData.notificationList=[R],t.passengerData.allNotification.unshift(t.handleData.clone(R))}t.handleData.updateDocumentField(y,"allNotification",t.passengerData.allNotification),t.handleData.updateDocumentField(y,"notificationList",t.passengerData.notificationList),t.handleData.updateDocumentField(y,"isNotification",!0)}}}else console.log("User not found")}catch(x){console.error("Error:",x)}t.passengerData=T}}}catch(o){console.error("Error in startStopRideByDriverNotification:",o)}})()}startStopByPassNotification(i){var t=this;return(0,v.A)(function*(){try{yield t.getCurrentLoc();const o=t.rideCreator.ride.rideList.find(l=>l.id===t.currentRideId),c=t.currentUser.ride.rideList.find(l=>l.id===t.currentRideId);console.log("matchedRideInCurrentUserList === ",c);const p=i[0];if(console.log("matchedRide is === ",o),null!=c){const l=t.currentUser.ride.rideList.find(h=>h.id===t.currentRideId);if(null!=l){var n,d;const h=new Date,D=null!==(n=t.datePipe.transform(h,"HH:mm:ss"))&&void 0!==n?n:"",y=null!==(d=t.datePipe.transform(h,"yyyy-MM-dd"))&&void 0!==d?d:"";if("start"===i[0]){var s;l.status="RideStarted",l.travelDetails.startlocation=null!==(s=t.currentLoc)&&void 0!==s?s:"Unknown Location",l.travelDetails.startTime=D,l.travelDetails.startDate=y}else{var m;l.status="RideStopped",l.travelDetails.endTime=D,l.travelDetails.endlocation=null!==(m=t.currentLoc)&&void 0!==m?m:"Unknown Location";const C=t.timeStringToDate(l.travelDetails.startTime),x=t.timeStringToDate(l.travelDetails.endTime).getTime()-C.getTime(),w=Math.floor(x/36e5),R=Math.floor(x%36e5/6e4);l.travelDetails.traveledTime=`${w} hours and ${R} minutes`,t.router.navigate(["/feedback"],{state:{matchedRideToDisplay:t.matchedRideToDisplay,driverData:t.rideCreator}})}t.handleData.updateDocumentField(t.currentUserDocId,"ride",t.currentUser.ride)}let f;f="start"===p?{senderName:t.currentUser.userName,status:"RideStarted",message:"Ride has Started",rideid:t.currentRideId,url:"notification",Ridedata:t.ride}:{senderName:t.currentUser.userName,status:"RideStopped",message:"Ride is completed",rideid:t.currentRideId,url:"notification",Ridedata:t.ride},o&&t.handleData.clone(o.passengerList).find(y=>y.passId===t.currentUserDocId)&&(!0===t.rideCreator.isNotification?t.rideCreator.notificationList.unshift(t.handleData.clone(f)):t.rideCreator.notificationList=[f],t.rideCreator.allNotification.unshift(t.handleData.clone(f)),t.handleData.updateDocumentField(t.ride.riderUserId,"allNotification",t.rideCreator.allNotification),t.handleData.updateDocumentField(t.ride.riderUserId,"notificationList",t.rideCreator.notificationList),t.handleData.updateDocumentField(t.ride.riderUserId,"ride",t.rideCreator.ride),t.handleData.updateDocumentField(t.ride.riderUserId,"isNotification",!0))}}catch(o){console.error("Error in startStopRideByDriverNotification:",o)}})()}}return(r=u).\u0275fac=function(i){return new(i||r)(e.\u0275\u0275directiveInject(P.nX),e.\u0275\u0275directiveInject(S.vh))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-ride-detail-view"]],standalone:!0,features:[e.\u0275\u0275ProvidersFeature([S.vh]),e.\u0275\u0275StandaloneFeature],decls:7,vars:2,consts:[["modal",""],[3,"translucent"],["slot","start"],[4,"ngIf"],[1,"ion-padding"],["size","12",1,"route"],["size","12",1,""],[1,"travelDetails"],[1,"location"],[1,"locationIcon","svg-container"],["src","../../../assets/images/svgs/start.svg","alt","",1,"pin-img"],["src","../../../assets/images/svgs/route.svg","alt",""],[1,"locationToFrom"],[1,""],["size","12",1,"dest-container","ion-padding-bottom"],[1,"location","end"],[1,"locationIcon","round"],["src","../../../assets/images/svgs/round.svg","alt","",1,"pin-img","red-filter"],["size","12",1,"ride-detail-container"],[1,"ride-detail"],["class","ride-detail",4,"ngIf"],[3,"ngClass"],[1,"statusArea",3,"ngSwitch"],[4,"ngSwitchCase"],["size","12","class"," ",4,"ngIf"],[1,"profile"],["alt","Profile pic",3,"src"],["size","12",1,"dest-container"],["lines","none",1,"ion-no-padding"],[1,"ion-padding-end",3,"color","name"],["color","primary",4,"ngIf"],[1,"rideActivity"],["slot","primary"],["fill","outline",3,"click"],["fill","outline"],[1,"cancelBtn","ion-padding-horizontal","ion-padding-bottom"],["expand","block","id","open-cancel-dialog","class","danger",4,"ngIf"],["trigger","open-cancel-dialog",1,"cancelModal"],[1,"ion-padding-horizontal","ion-padding-bottom"],["expand","block",1,"primary",3,"click","disabled"],["slot","primary",3,"click"],["fill","outline",3,"disabled"],["name","create"],["color","primary"],[1,"stars"],["name","thumbs-up-outline",1,"ion-padding-end","ion-color-success"],["color","warning",3,"name",4,"ngFor","ngForOf"],["color","warning",3,"name"],[4,"ngFor","ngForOf"],["class","ion-padding",4,"ngIf"],["size","4",1,""],["expand","block",1,"primary",3,"click"],["expand","block",1,"danger",3,"click"],["expand","block","id","open-cancel-dialog",1,"danger"],[1,"ion-padding-horizontal"],["lines","none","button","true","detail","false",1,"success","ion-text-center",3,"click"],["lines","none","button","true","detail","false",1,"danger","ion-text-center",3,"click"]],template:function(i,t){1&i&&(e.\u0275\u0275elementStart(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.\u0275\u0275element(3,"ion-menu-button"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-title"),e.\u0275\u0275text(5,"ride-detail-view"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(6,de,139,43,"ion-content",3)),2&i&&(e.\u0275\u0275property("translucent",!0),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",void 0!==t.currentUser))},dependencies:[g.Sb,g.QW,g.iq,g.uz,g.he,g.Jm,g.ln,g.hU,g.b_,g.W9,g.eU,g.BC,g.ai,S.MD,S.YU,S.Sq,S.bT,S.ux,S.e1,b.YN,g.MC],styles:["ion-col{min-height:auto}  p{margin:0}ion-card[_ngcontent-%COMP%]{box-shadow:#0003 0 3px 25px 2px,#00000024 1px 3px 7px -2px,#0000001f -12px 12px 21px}ion-card[_ngcontent-%COMP%]   .route[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:2px dashed rgba(128,128,128,.2196078431)}ion-card[_ngcontent-%COMP%]   .route[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{font-size:larger;font-weight:700;color:#000}ion-card[_ngcontent-%COMP%]   .travelDetails[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{color:#bad4da;font-weight:700;font-size:12px;margin-top:.8125rem}ion-card[_ngcontent-%COMP%]   .travelDetails[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{font-size:16px;margin-top:0;margin-bottom:0;display:flex;gap:.5rem;align-items:flex-start}ion-card[_ngcontent-%COMP%]   .travelDetails[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]   .locationIcon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem;color:#d3e3e7}ion-row.ion-padding-horizontal.md[_ngcontent-%COMP%]{display:flex;flex-direction:column}.red-filter[_ngcontent-%COMP%]{filter:grayscale(100%) sepia(100%) hue-rotate(-50deg) saturate(10000%)}.round[_ngcontent-%COMP%]{padding:0 .3rem}.svg-container[_ngcontent-%COMP%]{max-width:1.5rem;min-width:1.5rem;display:flex;flex-direction:column;gap:.5rem}.profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2rem;max-width:2rem;min-height:2rem;min-width:2rem;border-radius:50%}.locationToFrom[_ngcontent-%COMP%]{width:100%;text-overflow:ellipsis;text-wrap:nowrap;overflow:hidden}.requestedCss[_ngcontent-%COMP%], .pendingCss[_ngcontent-%COMP%], .acceptedCss[_ngcontent-%COMP%], .ongoingCss[_ngcontent-%COMP%], .completedCss[_ngcontent-%COMP%], .canceledCss[_ngcontent-%COMP%]{color:#fff;background-color:#00f;border-radius:10px;width:-moz-fit-content;width:fit-content;padding:.2rem .6rem;font-weight:700}.canceledCss[_ngcontent-%COMP%]{background-color:red}.cancelBtn[_ngcontent-%COMP%]{width:100%}.rideActivity[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{margin:1rem}.ride-detail-container[_ngcontent-%COMP%]{padding-top:1rem;border-top:2px dashed rgba(128,128,128,.2196078431)}.ride-detail-container[_ngcontent-%COMP%]   .ride-detail[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.ride-detail-container[_ngcontent-%COMP%]   .ride-detail[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0}  .editRideModalCss{--height: 300px;--max-width: 375px;--backdrop-opacity: .5 !important;--border-radius: 8px;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}  .cancelModal{--height: 180px;--max-width: 375px;--backdrop-opacity: .5 !important;--border-radius: 8px;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}  .cancelModal div{display:flex;flex-direction:column;justify-content:center;align-items:center}.stars[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem;color:gray}"]}),u})()}}]);